<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<title>Checkout - STORE RAYAN</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:'Arial',sans-serif;margin:0;background:#f5f5f5;color:#333;}
header{background:#2c3e50;color:white;padding:1rem 2rem;text-align:center;box-shadow:0 2px 8px rgba(0,0,0,0.2);}
header h1{margin:0;font-size:1.5rem;}
.container{max-width:1000px;margin:2rem auto;padding:1rem;background:white;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,.1);}
.user-info h2{margin:0 0 .5rem 0;font-size:1.2rem;color:#2c3e50;}
table{width:100%;border-collapse:collapse;margin-bottom:1.5rem;}
table th,table td{text-align:center;padding:10px;border-bottom:1px solid #ddd;}
table th{background:#2c3e50;color:white;}
table img{width:70px;height:50px;object-fit:cover;border-radius:6px;}
.total{text-align:left;font-size:1.1rem;font-weight:bold;color:#27ae60;margin-top:1rem;}
form{margin-top:1.5rem;}
form label{display:block;margin:.5rem 0 .2rem;}
form input, form textarea{width:100%;padding:.6rem;border:1px solid #ccc;border-radius:8px;font-size:1rem;}
form textarea{resize:vertical;min-height:70px;}
.actions{text-align:center;margin-top:1.5rem;}
.actions button{background:#e67e22;color:white;border:none;padding:.8rem 2rem;border-radius:10px;font-size:1.1rem;cursor:pointer;transition:.3s;}
.actions button:hover{background:#ca6f1e;}
.empty{text-align:center;font-size:1.1rem;color:#777;padding:2rem;}
</style>
</head>
<body>

<header>
  <h1>ğŸ’³ Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ - STORE RAYAN</h1>
</header>

<div class="container">
  <div class="user-info" id="userInfo"></div>

  <div id="cartContainer"></div>

  <!-- ÙÙˆØ±Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø­Ù† -->
  <form id="shippingForm">
    <h2>ğŸ“¦ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø­Ù†</h2>
    <label for="fullName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</label>
    <input type="text" id="fullName" required>

    <label for="email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</label>
    <input type="email" id="email" required>

    <label for="address">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ø­Ù†:</label>
    <textarea id="address" required></textarea>

    <label for="phone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
    <input type="tel" id="phone" required>
  </form>

  <div class="actions">
    <button onclick="confirmOrder()">âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø´Ø±Ø§Ø¡</button>
  </div>
</div>

<script>
// Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
const loggedUser = JSON.parse(localStorage.getItem("loggedUser"));
if(!loggedUser){
  alert("Ø§Ù„Ù…Ø±Ø¬Ùˆ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡.");
  window.location.href = "login.html";
}

// Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
document.getElementById("userInfo").innerHTML = `
  <h2>ğŸ‘¤ Ù…Ø±Ø­Ø¨Ø§ ${loggedUser.name}</h2>
  <p><b>Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„Ù…Ø³Ø¬Ù„:</b> ${loggedUser.email}</p>
`;

// Ø¬Ù„Ø¨ Ø§Ù„Ø³Ù„Ø©
const cart = JSON.parse(localStorage.getItem("cart")) || [];
const cartContainer = document.getElementById("cartContainer");

if(cart.length===0){
  cartContainer.innerHTML = `<div class="empty">ğŸ›’ Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>`;
  document.querySelector(".actions").style.display="none";
} else {
  let total = 0;
  let rows = cart.map((p,i)=>{
    let sum = p.price * (p.qty||1);
    total += sum;
    return `
      <tr>
        <td><img src="${p.img}" alt="${p.name}"></td>
        <td>${p.name}</td>
        <td>${p.price} Ø¯Ø±Ù‡Ù…</td>
        <td>${p.qty||1}</td>
        <td>${sum} Ø¯Ø±Ù‡Ù…</td>
      </tr>
    `;
  }).join("");

  cartContainer.innerHTML = `
    <table>
      <thead>
        <tr>
          <th>Ø§Ù„ØµÙˆØ±Ø©</th>
          <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
          <th>Ø§Ù„Ø³Ø¹Ø±</th>
          <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
          <th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th>
        </tr>
      </thead>
      <tbody>
        ${rows}
      </tbody>
    </table>
    <div class="total">ğŸ’° Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total} Ø¯Ø±Ù‡Ù…</div>
  `;
}

// ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨
function confirmOrder(){
  const fullName = document.getElementById("fullName").value.trim();
  const email = document.getElementById("email").value.trim();
  const address = document.getElementById("address").value.trim();
  const phone = document.getElementById("phone").value.trim();

  if(!fullName || !email || !address || !phone){
    alert("âš ï¸ Ø§Ù„Ù…Ø±Ø¬Ùˆ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.");
    return;
  }

  // Ù‡Ù†Ø§ Ù…Ù…ÙƒÙ† ØªØ¨Ø¹Ø« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø³ÙŠØ±ÙØ± Ø£Ùˆ ØªØ®Ø²Ù†Ù‡Ø§
  const order = {
    user: loggedUser,
    shipping: {fullName,email,address,phone},
    cart
  };

  console.log("ğŸ“¦ Ø·Ù„Ø¨ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©:", order);
  alert("âœ… ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ!\nØ³Ù†ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§ Ø¹Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.");
  localStorage.removeItem("cart");
  window.location.href = "index.html";
}
</script>
</body>
</html>
